{"version":3,"sources":["../src/lockfile.ts"],"names":["lockFile","name","callback","Promise","resolve","then","catch","err"],"mappings":";;;;;;;AAKA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAMA,QAAQ,GAAG,UAASC,IAAT,EAAuBC,QAAvB,EAAiD;AAChEC,EAAAA,OAAO,CAACC,OAAR,GACGC,IADH,CACQ,MAAM;AACV,WAAO,oBAAQJ,IAAR,CAAP;AACD,GAHH,EAIGI,IAJH,CAIQ,MAAM;AACV,WAAO,qBAASJ,IAAT,CAAP;AACD,GANH,EAOGI,IAPH,CAOQ,MAAM;AACV,WAAO,qBAASJ,IAAT,CAAP;AACD,GATH,EAUGI,IAVH,CAUQ,MAAM;AACVH,IAAAA,QAAQ,CAAC,IAAD,CAAR;AACD,GAZH,EAaGI,KAbH,CAaSC,GAAG,IAAI;AACZL,IAAAA,QAAQ,CAACK,GAAD,CAAR;AACD,GAfH;AAgBD,CAjBD","sourcesContent":["import fs from 'fs';\n\nimport locker from 'lockfile';\nimport { Callback } from '@verdaccio/types';\n\nimport { lockfile, statDir, statfile } from './utils';\n\n/**\n * locks a file by creating a lock file\n * @param name\n * @param callback\n */\nconst lockFile = function(name: string, callback: Callback): void {\n  Promise.resolve()\n    .then(() => {\n      return statDir(name);\n    })\n    .then(() => {\n      return statfile(name);\n    })\n    .then(() => {\n      return lockfile(name);\n    })\n    .then(() => {\n      callback(null);\n    })\n    .catch(err => {\n      callback(err);\n    });\n};\n\nexport { lockFile };\n"],"file":"lockfile.js"}