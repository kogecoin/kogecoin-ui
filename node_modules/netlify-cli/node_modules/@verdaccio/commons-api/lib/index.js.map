{"version":3,"sources":["../src/index.ts"],"names":["DEFAULT_MIN_LIMIT_PASSWORD","HTTP_STATUS","OK","httpCodes","CREATED","MULTIPLE_CHOICES","NOT_MODIFIED","BAD_REQUEST","UNAUTHORIZED","FORBIDDEN","NOT_FOUND","CONFLICT","UNSUPPORTED_MEDIA","UNSUPPORTED_MEDIA_TYPE","BAD_DATA","UNPROCESSABLE_ENTITY","INTERNAL_ERROR","INTERNAL_SERVER_ERROR","SERVICE_UNAVAILABLE","LOOP_DETECTED","HEADERS","ACCEPT","ACCEPT_ENCODING","USER_AGENT","JSON","CONTENT_TYPE","CONTENT_LENGTH","TEXT_PLAIN","TEXT_HTML","AUTHORIZATION","FORWARDED_PROTO","FRAMES_OPTIONS","CSP","CTO","XSS","ETAG","JSON_CHARSET","OCTET_STREAM","TEXT_CHARSET","WWW_AUTH","GZIP","API_MESSAGE","PKG_CREATED","PKG_CHANGED","PKG_REMOVED","PKG_PUBLISHED","TARBALL_UPLOADED","TARBALL_REMOVED","TAG_UPDATED","TAG_REMOVED","TAG_ADDED","LOGGED_OUT","API_ERROR","PASSWORD_SHORT","passLength","MUST_BE_LOGGED","PLUGIN_ERROR","CONFIG_BAD_FORMAT","BAD_USERNAME_PASSWORD","NO_PACKAGE","PACKAGE_CANNOT_BE_ADDED","NOT_ALLOWED","NOT_ALLOWED_PUBLISH","UNKNOWN_ERROR","NOT_PACKAGE_UPLINK","UPLINK_OFFLINE_PUBLISH","UPLINK_OFFLINE","CONTENT_MISMATCH","NOT_FILE_UPLINK","MAX_USERS_REACHED","VERSION_NOT_EXIST","FILE_NOT_FOUND","BAD_STATUS_CODE","PACKAGE_EXIST","BAD_AUTH_HEADER","WEB_DISABLED","DEPRECATED_BASIC_HEADER","BAD_FORMAT_USER_GROUP","RESOURCE_UNAVAILABLE","BAD_PACKAGE_DATA","USERNAME_PASSWORD_REQUIRED","USERNAME_ALREADY_REGISTERED","getError","code","message","httpError","getConflict","getBadData","customMessage","getBadRequest","getInternalError","getUnauthorized","getForbidden","getServiceUnavailable","getNotFound","getCode","statusCode"],"mappings":"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","sourcesContent":["import createError, { HttpError } from 'http-errors';\nimport httpCodes from 'http-status-codes';\n\nexport const DEFAULT_MIN_LIMIT_PASSWORD = 3;\n\nexport const HTTP_STATUS = {\n  OK: httpCodes.OK,\n  CREATED: httpCodes.CREATED,\n  MULTIPLE_CHOICES: httpCodes.MULTIPLE_CHOICES,\n  NOT_MODIFIED: httpCodes.NOT_MODIFIED,\n  BAD_REQUEST: httpCodes.BAD_REQUEST,\n  UNAUTHORIZED: httpCodes.UNAUTHORIZED,\n  FORBIDDEN: httpCodes.FORBIDDEN,\n  NOT_FOUND: httpCodes.NOT_FOUND,\n  CONFLICT: httpCodes.CONFLICT,\n  UNSUPPORTED_MEDIA: httpCodes.UNSUPPORTED_MEDIA_TYPE,\n  BAD_DATA: httpCodes.UNPROCESSABLE_ENTITY,\n  INTERNAL_ERROR: httpCodes.INTERNAL_SERVER_ERROR,\n  SERVICE_UNAVAILABLE: httpCodes.SERVICE_UNAVAILABLE,\n  LOOP_DETECTED: 508,\n};\n\nexport const HEADERS = {\n  ACCEPT: 'Accept',\n  ACCEPT_ENCODING: 'Accept-Encoding',\n  USER_AGENT: 'User-Agent',\n  JSON: 'application/json',\n  CONTENT_TYPE: 'Content-type',\n  CONTENT_LENGTH: 'content-length',\n  TEXT_PLAIN: 'text/plain',\n  TEXT_HTML: 'text/html',\n  AUTHORIZATION: 'authorization',\n  FORWARDED_PROTO: 'X-Forwarded-Proto',\n  FRAMES_OPTIONS: 'X-Frame-Options',\n  CSP: 'Content-Security-Policy',\n  CTO: 'X-Content-Type-Options',\n  XSS: 'X-XSS-Protection',\n  ETAG: 'ETag',\n  JSON_CHARSET: 'application/json; charset=utf-8',\n  OCTET_STREAM: 'application/octet-stream; charset=utf-8',\n  TEXT_CHARSET: 'text/plain; charset=utf-8',\n  WWW_AUTH: 'WWW-Authenticate',\n  GZIP: 'gzip',\n};\n\nexport const API_MESSAGE = {\n  PKG_CREATED: 'created new package',\n  PKG_CHANGED: 'package changed',\n  PKG_REMOVED: 'package removed',\n  PKG_PUBLISHED: 'package published',\n  TARBALL_UPLOADED: 'tarball uploaded successfully',\n  TARBALL_REMOVED: 'tarball removed',\n  TAG_UPDATED: 'tags updated',\n  TAG_REMOVED: 'tag removed',\n  TAG_ADDED: 'package tagged',\n  LOGGED_OUT: 'Logged out',\n};\n\nexport const API_ERROR = {\n  PASSWORD_SHORT: (passLength = DEFAULT_MIN_LIMIT_PASSWORD): string =>\n    `The provided password is too short. Please pick a password longer than ${passLength} characters.`,\n  MUST_BE_LOGGED: 'You must be logged in to publish packages.',\n  PLUGIN_ERROR: 'bug in the auth plugin system',\n  CONFIG_BAD_FORMAT: 'config file must be an object',\n  BAD_USERNAME_PASSWORD: 'bad username/password, access denied',\n  NO_PACKAGE: 'no such package available',\n  PACKAGE_CANNOT_BE_ADDED: 'this package cannot be added',\n  BAD_DATA: 'bad data',\n  NOT_ALLOWED: 'not allowed to access package',\n  NOT_ALLOWED_PUBLISH: 'not allowed to publish package',\n  INTERNAL_SERVER_ERROR: 'internal server error',\n  UNKNOWN_ERROR: 'unknown error',\n  NOT_PACKAGE_UPLINK: 'package does not exist on uplink',\n  UPLINK_OFFLINE_PUBLISH: 'one of the uplinks is down, refuse to publish',\n  UPLINK_OFFLINE: 'uplink is offline',\n  CONTENT_MISMATCH: 'content length mismatch',\n  NOT_FILE_UPLINK: \"file doesn't exist on uplink\",\n  MAX_USERS_REACHED: 'maximum amount of users reached',\n  VERSION_NOT_EXIST: \"this version doesn't exist\",\n  FILE_NOT_FOUND: 'File not found',\n  BAD_STATUS_CODE: 'bad status code',\n  PACKAGE_EXIST: 'this package is already present',\n  BAD_AUTH_HEADER: 'bad authorization header',\n  WEB_DISABLED: 'Web interface is disabled in the config file',\n  DEPRECATED_BASIC_HEADER: 'basic authentication is deprecated, please use JWT instead',\n  BAD_FORMAT_USER_GROUP: 'user groups is different than an array',\n  RESOURCE_UNAVAILABLE: 'resource unavailable',\n  BAD_PACKAGE_DATA: 'bad incoming package data',\n  USERNAME_PASSWORD_REQUIRED: 'username and password is required',\n  USERNAME_ALREADY_REGISTERED: 'username is already registered',\n};\n\nexport type VerdaccioError = HttpError & { code: number };\n\nfunction getError(code: number, message: string): VerdaccioError {\n  const httpError = createError(code, message);\n\n  httpError.code = code;\n\n  return httpError as VerdaccioError;\n}\n\nexport function getConflict(message: string = API_ERROR.PACKAGE_EXIST): VerdaccioError {\n  return getError(HTTP_STATUS.CONFLICT, message);\n}\n\nexport function getBadData(customMessage?: string): VerdaccioError {\n  return getError(HTTP_STATUS.BAD_DATA, customMessage || API_ERROR.BAD_DATA);\n}\n\nexport function getBadRequest(customMessage: string): VerdaccioError {\n  return getError(HTTP_STATUS.BAD_REQUEST, customMessage);\n}\n\nexport function getInternalError(customMessage?: string): VerdaccioError {\n  return customMessage\n    ? getError(HTTP_STATUS.INTERNAL_ERROR, customMessage)\n    : getError(HTTP_STATUS.INTERNAL_ERROR, API_ERROR.UNKNOWN_ERROR);\n}\n\nexport function getUnauthorized(message = 'no credentials provided'): VerdaccioError {\n  return getError(HTTP_STATUS.UNAUTHORIZED, message);\n}\n\nexport function getForbidden(message = \"can't use this filename\"): VerdaccioError {\n  return getError(HTTP_STATUS.FORBIDDEN, message);\n}\n\nexport function getServiceUnavailable(message: string = API_ERROR.RESOURCE_UNAVAILABLE): VerdaccioError {\n  return getError(HTTP_STATUS.SERVICE_UNAVAILABLE, message);\n}\n\nexport function getNotFound(customMessage?: string): VerdaccioError {\n  return getError(HTTP_STATUS.NOT_FOUND, customMessage || API_ERROR.NO_PACKAGE);\n}\n\nexport function getCode(statusCode: number, customMessage: string): VerdaccioError {\n  return getError(statusCode, customMessage);\n}\n"],"file":"index.js"}